select 
pc.player_id,
pc.game_id,
pc.player_name,
pc.nba_pos,
fp.position fd_pos,
fp.salary,
fp.injury_indicator,
fp.injury_details,
pc.game_date,
pc.player_dr,
pc.team,
pc.opp_team,
pc.team_loc,
pc.min_game,
pc.moving_avg_min,
pc.rest_mins,
pc.loc_mins,
pc.fdpts_game,
pc.moving_avg_fdpts,
pc.rest_fdpts,
pc.loc_fdpts,
pc.pie_game,
pc.pie_season,
pc.moving_avg_pie,
pc.rest_pie,
pc.loc_pie,
pc.opp_w_pct,
pc.opp_off_rating,
pc.opp_def_rating,
pc.opp_net_rating,
pc.d_fgm,
pc.d_fga,
pc.d_fg_pct,
pc.normal_fg_pct,
pc.pct_plusminus
from rpt.mvw_player_schedule ps
    inner join ( select t.*,
		        row_number() over ( partition by player_id order by game_date desc) rn
                   from rpt.mvw_player_consolidated t ) pc on ( ps.player_id = pc.player_id and
						                pc.rn = 1)
    inner JOIN lnd.vw_fd_players fp ON ps.player = (fp.first_name || ' ' || fp.last_name)
where ps.game_date = to_char('now'::date::timestamp with time zone, 'YYYYMMDD')::bigint
limit 100  